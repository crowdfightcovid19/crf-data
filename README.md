# I/O data folder

This folder contains raw and generated data from different scripts in the project.

## Directory structure 

Files can be of the type:

* INPUT: Downloaded from Google Drive, MaileLite or FreshDesk.
* USED: Generated and used somewhere else in the pipeline. Some could be deleted afterwards.
* NOT USED: Generated and not used, but potentially useful.
* BYPRODUCT: Generated and can be deleted because the info is somewhere else or they do not contain useful information.
* OUTPUT: Uploaded to Google Drive or sent to some other members of the platform. 

        .
        ├── freshdesk_tickets           # Data from the FreshDesk system. Scientists requests with scientists interactions.
            ├── requests_emails         # Generated by `convert_xml_requests_to_csv.py`. BYPRODUCT.
                ├── *_emails.txt        # Contains the emails of a given request. BYPRODUCT
            ├── requests_emails.zip     # Compressed version of the previous folder. OUTPUT
            ├── readme.md               # Just to create the folder structure in the repository
            ├── 1372943 (XX).zip        # Downloaded from the FreshDesk system. INPUT
            ├── Companies*.xml          # Generated after unziping 1372943 (XX).zip. BYPRODUCT
            ├── Forums.xml              # Generated after unziping 1372943 (XX).zip. BYPRODUCT
            ├── Groups.xml              # Generated after unziping 1372943 (XX).zip. BYPRODUCT
            ├── Solutions.xml           # Generated after unziping 1372943 (XX).zip. BYPRODUCT
            ├── Users*.xml              # Generated after unziping 1372943 (XX).zip. BYPRODUCT
            ├── Tickets*.xml            # Generated after unziping 1372943 (XX).zip. USED
            ├── Tickets.csv             # Generated by `convert_xml_requests_to_csv.py`. OUTPUT
            └── requests_freshdesk.csv  # Generated by `pseudonymize_data.py`. USED       
        ├── task_distribution                                   # Scripts to preprocess data and their unittests 
            ├── readme.md                                       # Just to create the folder structure in the repository
            ├── drive-download-YYYYMMDDTHHMMSS-001.zip          # Downloaded from Google Drive. INPUT
            ├── Task distribution YYYYMMDD (Responses).xlsx     # Generated by unzipping the previous file. USED
            ├── Task distribution YYYYMMDD (Responses).csv      # Generated by `convert_xlsx_formst_to_csv.py`. USED
            ├── tasks_distribution_YYYYMMDD.csv                 # Generated by `pseudonymize_data.py`. USED
            ├── tasks_descriptions.csv                          # Generated by `join_tasks_distribution_data.py`, but not when using `preprocessed_data.py`. USED
            ├── volunteer_extra_information.csv                 # Generated by `join_tasks_distribution_data.py`, but not when using `preprocessed_data.py`. USED
            ├── volunteers_polls_responses.csv                  # Generated by `join_tasks_distribution_data.py` or `preprocessed_data.py`. NOT USED 
            ├── volunteers_tasks_expertise.csv                  # Generated by `join_tasks_distribution_data.py` or `preprocessed_data.py`. NOT USED
            └── volunteers_tasks_ratings.csv                    # Generated by `join_tasks_distribution_data.py` or `preprocessed_data.py`. USED
        ├── README.md                                                   # This file
        ├── Crowdfight COVID-19 volunteer database (Responses).xlsx     # File with volunteers subscriptions. RAW
        ├── Crowdfight COVID-19 volunteer database (Responses).csv      # Generated by `convert_xlsx_forms_to_csv.py`. USED
        ├── mailerlite.csv                                              # Generated by `convert_json_mailerlite_to_csv.py`. USED
        ├── volunteers_google_form.csv                                  # Generated by `pseudonimyze_data.py`. USED
        ├── volunteers_mailerlite.csv                                   # Generated by `pseudonimyze_data.py`. USED
        ├── volunteers_hashes.csv                                       # Generated by `pseudonimyze_data.py`. OUTPUT
        ├── volunteers.csv                                              # Generated by `join_volunteers_databases.py` or `preprocessed_data.py`. OUTPUT
        ├── tasks.csv                                                   # Generated by `join_tasks_descriptions_and_requests.py` or `preprocessed_data.py`. USED
        ├── ratings_train.csv                                           # Generated by `generate_ratings_train.py`. USED
        ├── tasks_vectors.pkl                                           # Generated by `script_precompute_vectors.py`. USED
        ├── volunteers_vectors.pkl                                      # Generated by `script_precompute_vectors.py`. USED
        ├── tasks_with_cluster_affinities.csv                           # Generated by `script_neural_network_cluster.py`. USED
        ├── volunteers_with_cluster_affinities.csv                      # Generated by `script_neural_network_cluster.py`. USED
        ├── requests_cluster_*.csv                                      # Generated by `script_split_up_clusters_to_csv.py`. OUTPUT
        ├── volunteers_cluster_*.csv                                    # Generated by `script_split_up_clusters_to_csv.py`. OUTPUT
        └── tasks_form_cluster_*.csv                                    # Generated by `script_clusters_to_tasks_form.py`. OUTPUT
                   

## Accessing the raw data. 

The following explains how we currently access the data. Most of it is accessed manually but it is meant to be
automatized in the future.

### Volunteers raw data

Volunteers subscribe to the platform filling a Google Form and subscribing to MailerLite (platform used to send 
different kind of emails to the volunteers)

* `Crowdfight COVID-19 volunteer database (Responses).xlsx` is downloaded from Google Drive. It contains 
volunteers information and descriptions from the Google Form that they fill at subscription.
* `~($HOME)/mailerlite_YYYYMMDD-HHMM_<type>.json` is downloaded from MailerLite through the mailerlite_backup.py 
script in a different repository of CrowdFight-COVID19. It contains information about the volunteers 
subscriptions to MailerLite and their interaction with the emails sent.  

### Requests raw data

Requests from researchers arrive to the FreshDesk platform where they are managed, labeled and filled with a given
task list. All this is done manually by coordinators of CrowdFight-COVID19.

* `./freshdesk_tickets/1372943 (XX).zip` is downloaded from the FreshDesk platform. It contains multiple XML files
from which only the `Tickets*.xml` are important. They contain the information about the different requests from the
researchers. 

### Tasks distribution forms raw data

Volunteers receive every 2-4 days an email with a Google Form containing the descriptions of several tasks. They fill
the Google Form indicating how suitable they are for each of the tasks.

* `./task_distribution/drive-download-YYYYMMDDTHHMMSS-001.zip` is downloaded from Google Drive. It contains multiple
`Task distribution YYYYMMDD (Responses).xlsx` with the responses of the volunteers to the different task distribution 
forms sent on the date specified by YYYYMMDD. 

## Generating data

### Pseudonymized data

The previous data contains emails, names and IP addresses that are kept out or pseudonymized during the processing of 
the data. Data is pseudonymized with the command: `make pseudonym_data`, more information can be found in 
the [Makefile](../Makefile). 


### Preprocessed data

Data needs to be cleaned and given a proper format to simplify the functioning of other scripts in the pipeline. 
Data is preprocessed with the command: `make preprocessed_data`, more information can be found in the 
[Makefile](../Makefile). 

### Data for training

Some data is further preprocessed to simplify the functioning of the scripts used to train networks. This data is
generated with the command: `make datatrain`, more information can be found in the [Makefile](../Makefile)

### Vectors data

Tasks and volunteers vectors of semantic embeddings are also stored in this folder. Files of vectors are generated
with the command: `make vectors`, more information can be found in the [Makefile](../Makefile).

### Clusters data

Before sending an email with tasks distribution Google Form to the volunteers, the volunteers and tasks are 
clustered so that volunteers receive the tasks in order of relevance according to their expertise. The clustering
can be run with the command: `make clusters`, more information can be found in the [Makefile]






